import{j as e,e as w,r as h,a as S}from"./index-Ctau24pR.js";import{H as C}from"./Header-DF0lZ4nl.js";import{C as k,P as R}from"./PortraitCard-D0HA9YZU.js";function _({label:n,value:t,max:s}){const l=Math.max(0,Math.min(100,Math.round(t/s*100)));return e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsxs("div",{style:{fontSize:12,opacity:.9},children:[n,": ",t,"/",s]}),e.jsx("div",{style:{height:8,borderRadius:8,background:"rgba(255,255,255,0.06)",overflow:"hidden",border:"1px solid rgba(255,255,255,0.08)"},children:e.jsx("div",{style:{width:"".concat(l,"%"),height:"100%",background:"linear-gradient(90deg, rgba(216,180,106,0.6), rgba(216,180,106,0.9))"}})})]})}const $="_grid_18h21_1",E="_cell_18h21_6",I="_label_18h21_20",b={grid:$,cell:E,label:I},T={common:"rgba(255,255,255,0.10)",uncommon:"rgba(82,196,82,0.5)",rare:"rgba(82,156,255,0.5)",epic:"rgba(196,82,196,0.55)"};function M({items:n,onEquip:t}){return n=Array.isArray(n)?n:[],e.jsx("div",{className:b.grid,children:n.map(s=>e.jsx("button",{className:b.cell,style:{borderColor:T[s.rarity]},title:"".concat(s.name," • редкость: ").concat(s.rarity),onClick:()=>t(s),children:e.jsx("span",{className:b.label,children:s.name})},s.id))})}function L({player:n,onBack:t,onUpdatePlayer:s}){const l=k[n.classId],c=w(n),[u,v]=h.useState(null);h.useEffect(()=>{let r=!1;return(async()=>{try{const i=await S();!r&&(i!=null&&i.ok)&&i.data&&v(i.data.tag)}catch(i){}})(),()=>{r=!0}},[]);function j(r){var x,p;const i=r.slot;if(r.classReq&&r.classReq!==n.classId){alert("Нельзя экипировать: предмет другого класса");return}if(((x=r.requiredLevel)!=null?x:1)>n.progress.level){alert("Требуется ур. ".concat(r.requiredLevel));return}const g=n.inventory.filter(y=>y!==r),o=(p=n.equipment[i])!=null?p:null,m={...n.equipment,[i]:r},f=o?[...g,o]:g,q={...n,equipment:m,inventory:f};s(q)}function a(r){var o;const i=(o=n.equipment[r])!=null?o:null;if(!i)return;const g={...n,equipment:{...n.equipment,[r]:null},inventory:[...n.inventory,i]};s(g)}return e.jsxs("div",{style:{padding:16,display:"grid",gap:12},children:[e.jsx(C,{title:"Персонаж",gold:n.gold,energy:n.energy,level:n.progress.level,onBack:t,badgeTag:u}),e.jsx(R,{img:l.img,title:l.title,subtitle:"".concat(l.desc,". Ур. ").concat(n.progress.level," • Энергия: ").concat(n.energy,"/").concat(n.energyMax).concat(u?" • Гильдия: ".concat(u):""),size:"lg"}),e.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)",display:"grid",gap:10},children:[e.jsx("b",{children:"Характеристики"}),e.jsx(_,{label:"XP",value:n.progress.xp,max:n.progress.xpToNext}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{children:["Сила: ",c.str]}),e.jsxs("div",{children:["Ловкость: ",c.agi]}),e.jsxs("div",{children:["Интеллект: ",c.int]}),e.jsxs("div",{children:["Телосложение: ",c.vit]})]})]}),e.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)"},children:[e.jsx("b",{children:"Оружие"}),e.jsx(d,{label:"Оружие",item:n.equipment.weapon,onUnequip:()=>a("weapon")})]}),e.jsxs("section",{style:{display:"grid",gap:10,gridTemplateColumns:"1fr 1fr",alignItems:"start"},children:[e.jsxs("div",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)"},children:[e.jsx("b",{children:"Снаряжение"}),e.jsx(d,{label:"Шлем",item:n.equipment.helmet,onUnequip:()=>a("helmet")}),e.jsx(d,{label:"Верх",item:n.equipment.chest,onUnequip:()=>a("chest")}),e.jsx(d,{label:"Штаны",item:n.equipment.pants,onUnequip:()=>a("pants")}),e.jsx(d,{label:"Ботинки",item:n.equipment.boots,onUnequip:()=>a("boots")}),e.jsx(d,{label:"Перчатки",item:n.equipment.gloves,onUnequip:()=>a("gloves")})]}),e.jsxs("div",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)",display:"grid",gap:8},children:[e.jsx("b",{children:"Инвентарь"}),e.jsx(M,{items:n.inventory,onEquip:j})]})]})]})}function d({label:n,item:t,onUnequip:s}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},children:[e.jsx("div",{style:{opacity:.9},children:n}),e.jsx("div",{style:{opacity:.9},children:t?e.jsx("span",{children:t.name}):e.jsx("span",{style:{opacity:.7},children:"пусто"})}),e.jsx("div",{children:e.jsx("button",{disabled:!t,onClick:s,className:"mire-btn",style:{padding:"6px 10px",borderRadius:10},children:"Снять"})})]})}export{L as default};

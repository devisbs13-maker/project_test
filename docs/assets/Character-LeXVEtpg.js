import{j as e,e as Z,r as D,a as ee}from"./index-By2cNAY-.js";import{H as re}from"./Header-CHg887X4.js";import{C as se,P as te}from"./PortraitCard-CMUhurTp.js";import{g as p}from"./index-FU-_DbfN.js";import"./ru-DqIjrUCB.js";function ne({label:r,value:i,max:t}){const s=Math.max(0,Math.min(100,Math.round(i/t*100)));return e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsxs("div",{style:{fontSize:12,opacity:.9},children:[r,": ",i,"/",t]}),e.jsx("div",{style:{height:8,borderRadius:8,background:"rgba(255,255,255,0.06)",overflow:"hidden",border:"1px solid rgba(255,255,255,0.08)"},children:e.jsx("div",{style:{width:"".concat(s,"%"),height:"100%",background:"linear-gradient(90deg, rgba(216,180,106,0.6), rgba(216,180,106,0.9))"}})})]})}const ae="_grid_18h21_1",ie="_cell_18h21_6",oe="_label_18h21_20",b={grid:ae,cell:ie,label:oe},ce={common:"rgba(255,255,255,0.10)",uncommon:"rgba(82,196,82,0.5)",rare:"rgba(82,156,255,0.5)",epic:"rgba(196,82,196,0.55)"};function le({items:r,onEquip:i}){return r=Array.isArray(r)?r:[],e.jsx("div",{className:b.grid,children:r.map(t=>{var s,o;return e.jsx("button",{className:b.cell,style:{borderColor:ce[t.rarity]},title:"".concat(t.name," • ").concat((o=(s=p().merchant)==null?void 0:s.rarity)!=null?o:"Rarity",": ").concat(t.rarity),onClick:()=>i(t),children:e.jsx("span",{className:b.label,children:t.name})},t.id)})})}function be({player:r,onBack:i,onUpdatePlayer:t}){var x,v,m,j,q,f,y,w,C,S,R,$,T,k,I,_,E,A,M,N,U,L,P,B;const s=p(),o=se[r.classId],c=Z(r),[l,F]=D.useState(null);D.useEffect(()=>{let n=!1;return(async()=>{try{const a=await ee();!n&&(a!=null&&a.ok)&&a.data&&F(a.data.tag)}catch(a){}})(),()=>{n=!0}},[]);function J(n){var G,H,z,W,V,X;const a=n.slot;if(n.classReq&&n.classReq!==r.classId){alert((H=(G=s.character)==null?void 0:G.classMismatch)!=null?H:"Class mismatch: cannot equip");return}if(((z=n.requiredLevel)!=null?z:1)>r.progress.level){alert("".concat((V=(W=s.character)==null?void 0:W.levelReq)!=null?V:"Level required",": ").concat(n.requiredLevel));return}const g=r.inventory.filter(Y=>Y!==n),u=(X=r.equipment[a])!=null?X:null,K={...r.equipment,[a]:n},O=u?[...g,u]:g,Q={...r,equipment:K,inventory:O};t(Q)}function d(n){var u;const a=(u=r.equipment[n])!=null?u:null;if(!a)return;const g={...r,equipment:{...r.equipment,[n]:null},inventory:[...r.inventory,a]};t(g)}return e.jsxs("div",{style:{padding:16,display:"grid",gap:12},children:[e.jsx(re,{title:(v=(x=s.buttons)==null?void 0:x.character)!=null?v:"Character",gold:r.gold,energy:r.energy,level:r.progress.level,onBack:i,badgeTag:l}),e.jsx(te,{img:o.img,title:o.title,subtitle:"".concat(s.stats.level," ").concat(r.progress.level," • ").concat(s.stats.energy," ").concat(r.energy,"/").concat(r.energyMax).concat(l?" • Clan: ".concat(l):""),size:"lg"}),e.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)",display:"grid",gap:10},children:[e.jsx("b",{children:(j=(m=s.character)==null?void 0:m.progress)!=null?j:"Progress"}),e.jsx(ne,{label:(f=(q=s.character)==null?void 0:q.xp)!=null?f:"XP",value:r.progress.xp,max:r.progress.xpToNext}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{children:["STR: ",c.str]}),e.jsxs("div",{children:["AGI: ",c.agi]}),e.jsxs("div",{children:["INT: ",c.int]}),e.jsxs("div",{children:["VIT: ",c.vit]})]})]}),e.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)"},children:[e.jsx("b",{children:(w=(y=s.character)==null?void 0:y.equipment)!=null?w:"Equipment"}),e.jsx(h,{label:(S=(C=s.character)==null?void 0:C.weapon)!=null?S:"Weapon",item:r.equipment.weapon,onUnequip:()=>d("weapon")})]}),e.jsxs("section",{style:{display:"grid",gap:10,gridTemplateColumns:"1fr 1fr",alignItems:"start"},children:[e.jsxs("div",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)"},children:[e.jsx("b",{children:($=(R=s.character)==null?void 0:R.armor)!=null?$:"Armor"}),e.jsx(h,{label:(k=(T=s.character)==null?void 0:T.helmet)!=null?k:"Helmet",item:r.equipment.helmet,onUnequip:()=>d("helmet")}),e.jsx(h,{label:(_=(I=s.character)==null?void 0:I.chest)!=null?_:"Chest",item:r.equipment.chest,onUnequip:()=>d("chest")}),e.jsx(h,{label:(A=(E=s.character)==null?void 0:E.pants)!=null?A:"Pants",item:r.equipment.pants,onUnequip:()=>d("pants")}),e.jsx(h,{label:(N=(M=s.character)==null?void 0:M.boots)!=null?N:"Boots",item:r.equipment.boots,onUnequip:()=>d("boots")}),e.jsx(h,{label:(L=(U=s.character)==null?void 0:U.gloves)!=null?L:"Gloves",item:r.equipment.gloves,onUnequip:()=>d("gloves")})]}),e.jsxs("div",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",boxShadow:"var(--shadow)",display:"grid",gap:8},children:[e.jsx("b",{children:(B=(P=s.character)==null?void 0:P.inventory)!=null?B:"Inventory"}),e.jsx(le,{items:r.inventory,onEquip:J})]})]})]})}function h({label:r,item:i,onUnequip:t}){var s,o,c,l;return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},children:[e.jsx("div",{style:{opacity:.9},children:r}),e.jsx("div",{style:{opacity:.9},children:i?e.jsx("span",{children:i.name}):e.jsx("span",{style:{opacity:.7},children:(o=(s=p().character)==null?void 0:s.empty)!=null?o:"Empty"})}),e.jsx("div",{children:e.jsx("button",{disabled:!i,onClick:t,className:"mire-btn",style:{padding:"6px 10px",borderRadius:10},children:(l=(c=p().character)==null?void 0:c.unequip)!=null?l:"Unequip"})})]})}export{be as default};

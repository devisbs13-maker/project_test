import{r,a as j,j as a,m as y,E as _}from"./index-KSIM0t-z.js";import{H as N}from"./Header-Bx5OPXMv.js";import{B as o}from"./Button-DO4FSLJV.js";import{R as C}from"./ru-Dc4ir4dU.js";import{C as $,P as k}from"./PortraitCard-BJ26oqZt.js";import{f as E}from"./time-WGOIUK2d.js";const w={title:"Mirevald",navWhere:"Where to?",buttons:{quests:"Quests",jobs:"Jobs",monster:"Monster Hunt",merchant:"Merchant",arena:"PvP",guild:"Factions",character:"Character",back:"Back",backToVillage:"Back to village",confirm:"Confirm",start:"Start adventure",language:"Language"},stats:{energy:"Energy",gold:"Gold",level:"Lvl."}};function u(){try{const t=localStorage.getItem("mirevald:lang");if(t==="en"||t==="ru")return t}catch(t){}return"ru"}function z(t){try{localStorage.setItem("mirevald:lang",t)}catch(m){}}function T(){return u()==="en"?w:C}const F="_wrap_yzi99_2",L="_panel_yzi99_11",R="_titleRow_yzi99_24",I="_panelGlow_yzi99_31",M="_appear_yzi99_52 _panel_yzi99_11",G="_buttonList_yzi99_93",W="_btnFull_yzi99_100",n={wrap:F,panel:L,titleRow:R,panelGlow:I,appear:M,buttonList:G,btnFull:W};function V({player:t,onOpenQuests:m,onOpenJobs:d,onOpenArena:g,onOpenGuild:p,onOpenCharacter:x,setScreen:e}){const s=T(),c=$[t.classId],[b,h]=r.useState(null),[v,f]=r.useState(0);return r.useEffect(()=>{let i=!1;return(async()=>{try{const l=await j();!i&&(l!=null&&l.ok)&&l.data&&h(l.data.tag)}catch(l){}})(),()=>{i=!0}},[]),r.useEffect(()=>{const i=()=>f(y(t.lastEnergyTs,_,t.energy,t.energyMax));i();const l=setInterval(i,1e3);return()=>clearInterval(l)},[t.energy,t.energyMax,t.lastEnergyTs]),a.jsxs("div",{className:n.wrap,children:[a.jsx(N,{title:s.title,gold:t.gold,energy:t.energy,level:t.progress.level,badgeTag:b}),t.name?a.jsxs("div",{style:{margin:"8px 14px",fontSize:12,opacity:.9},children:["@",t.name]}):null,t.energy<t.energyMax?a.jsxs("div",{style:{margin:"0 14px 8px",fontSize:12,opacity:.75},children:["+1 ",s.stats.energy,": ",E(v)]}):null,a.jsx("section",{className:"".concat(n.panel," ").concat(n.panelGlow," ").concat(n.appear),children:a.jsx(k,{img:c.img,title:"".concat(t.name?"".concat(t.name," • "):"").concat(c.title),subtitle:"".concat(c.desc,". ").concat(s.stats.level," ").concat(t.progress.level," • ").concat(s.stats.energy,": ").concat(t.energy,"/").concat(t.energyMax),size:"md",rightSlot:a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx(o,{className:n.btnFull,onClick:()=>e==null?void 0:e("square"),children:s.navWhere}),a.jsx(o,{className:n.btnFull,onClick:x,children:s.buttons.character})]})})}),a.jsxs("section",{className:"".concat(n.panel," ").concat(n.panelGlow," ").concat(n.appear),children:[a.jsx("div",{className:n.titleRow,children:a.jsx("span",{style:{opacity:.85},children:s.navWhere})}),a.jsxs("div",{className:n.buttonList,children:[a.jsx(o,{className:n.btnFull,onClick:()=>{e==null||e("quests"),m()},children:s.buttons.quests}),a.jsx(o,{className:n.btnFull,onClick:()=>{e==null||e("jobs"),d()},children:s.buttons.jobs}),a.jsx(o,{className:n.btnFull,onClick:()=>e==null?void 0:e("monster"),children:s.buttons.monster}),a.jsx(o,{className:n.btnFull,onClick:()=>e==null?void 0:e("merchant"),children:s.buttons.merchant}),a.jsx(o,{className:n.btnFull,onClick:g,children:s.buttons.arena}),a.jsx(o,{className:n.btnFull,onClick:p,children:s.buttons.guild})]})]}),a.jsxs("section",{className:"".concat(n.panel," ").concat(n.appear),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{opacity:.7,fontSize:12},children:"Ник берётся из Telegram WebApp"}),a.jsx("button",{onClick:()=>{try{localStorage.removeItem("mirevald:player"),localStorage.removeItem("mirevald:session"),localStorage.removeItem("mirevald:clan")}catch(i){}location.reload()},style:{background:"transparent",border:"none",color:"var(--gold)",cursor:"pointer",fontSize:12,textDecoration:"underline"},"aria-label":"reset-profile",children:"Сбросить персонажа"})]}),a.jsx("div",{style:{marginTop:8},children:a.jsxs("button",{onClick:()=>{const l=u()==="ru"?"en":"ru";z(l),location.reload()},className:"mire-btn",style:{padding:"6px 10px",borderRadius:10},children:[s.buttons.language,": ",u().toUpperCase()]})})]})]})}export{V as default};

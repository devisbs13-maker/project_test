!function(){function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function t(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach(function(r){n(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function n(r,t,n){return(t=function(r){var t=function(r,t){if("object"!=e(r)||!r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var i=n.call(r,t||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}(r,"string");return"symbol"==e(t)?t:t+""}(t))in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function i(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=l(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,d=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){d=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(d)throw o}}}}function o(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,o,a,l=[],d=!0,u=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;d=!1}else for(;!(d=(n=o.call(t)).done)&&(l.push(n.value),l.length!==r);d=!0);}catch(e){u=!0,i=e}finally{try{if(!d&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,r)||l(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,r){if(e){if("string"==typeof e)return d(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,r):void 0}}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}System.register(["./index-legacy-C54gzF4w.js","./Header-legacy-tXmvuVNU.js","./Button-legacy-DeRXUO5G.js","./progression-legacy-BlqE10sL.js","./time-legacy-CAhSdEcu.js"],function(e,r){"use strict";var n,l,d,u,c,s,f,y,v,p,g,b,h,m,j;return{setters:[function(e){n=e.r,l=e.n,d=e.j,u=e.s},function(e){c=e.H},function(e){s=e.B},function(e){f=e.l,y=e.s,v=e.i,p=e.a,g=e.T,b=e.g},function(e){h=e.r,m=e.n,j=e.s}],execute:function(){e("default",function(e){var r=e.player,x=e.onBack,w=e.onUpdatePlayer,S=a(n.useState(function(){return f()}),2),k=S[0],A=S[1],O=n.useMemo(function(){return new Map(k.tasks.map(function(e){return[e.id,e]}))},[k.tasks]),P=n.useMemo(function(){return k.active.filter(function(e){return"quest"===e.kind})},[k.active]),I=n.useMemo(function(){return k.tasks.filter(function(e){return"quest"===e.kind})},[k.tasks,r.progress.level]);return n.useEffect(function(){var e=setInterval(function(){var e=k.active.filter(function(e){return h(e.endsAt)<=0});if(0!==e.length){var r,n=k.active.filter(function(e){return h(e.endsAt)>0}),a=o(k.vault),d=i(e);try{for(d.s();!(r=d.n()).done;){var u=r.value,c=O.get(u.id);c&&(a.push({id:c.id,kind:"quest",title:c.title,reward:c.reward,completedAt:m()}),l("quest",c.title,c.reward))}}catch(f){d.e(f)}finally{d.f()}var s=t(t({},k),{},{active:n,vault:a});A(s),y(s)}},1e3);return function(){return clearInterval(e)}},[k,O]),d.jsxs("div",{style:{padding:16,display:"grid",gap:12},children:[function(){try{return v(p())}catch(e){return!1}}()&&d.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)"},children:[d.jsx("b",{children:"–°–µ–π—á–∞—Å –∏–¥–µ—Ç –±–æ–π —Å –º–æ–Ω—Å—Ç—Ä–æ–º"}),d.jsx("div",{style:{opacity:.85,marginTop:6},children:"–í–æ –≤—Ä–µ–º—è –±–æ—è –Ω–µ–ª—å–∑—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–≤–µ—Å—Ç—ã. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –±–æ—è."})]}),d.jsx(c,{title:"–ö–≤–µ—Å—Ç—ã",gold:r.gold,energy:r.energy,level:r.progress.level,onBack:x}),d.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)"},children:[d.jsx("b",{children:"–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã"}),d.jsxs("div",{style:{display:"grid",gap:8,marginTop:8},children:[0===P.length&&d.jsx("div",{style:{opacity:.8},children:"–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è."}),P.map(function(e){var r,n,i=O.get(e.id);return i?d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:12,background:"var(--panel-bg)",border:"1px solid rgba(255,255,255,0.08)"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:700},children:i.title}),d.jsxs("div",{style:{opacity:.85,fontSize:12},children:["–ù–∞–≥—Ä–∞–¥–∞: ü™ô ",null!==(r=i.reward.gold)&&void 0!==r?r:0," ‚Ä¢ XP ",null!==(n=i.reward.xp)&&void 0!==n?n:0,i.reward.energy?" ‚Ä¢ —ç–Ω–µ—Ä–≥–∏—è +".concat(i.reward.energy):""]})]}),d.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[d.jsx(g,{endsAt:e.endsAt}),d.jsx(s,{onClick:function(){return function(e){var r=k.active.filter(function(r){return!("quest"===r.kind&&r.id===e.id&&r.startedAt===e.startedAt)}),n=t(t({},k),{},{active:r});A(n),y(n)}(e)},disabled:h(e.endsAt)<2e3,children:"–û—Ç–º–µ–Ω–∏—Ç—å"})]})]},e.startedAt+e.id):null})]})]}),d.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)"},children:[d.jsx("b",{children:"–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–≤–µ—Å—Ç—ã"}),d.jsx("div",{style:{display:"grid",gap:8,marginTop:8},children:I.map(function(e){var n,i,a,l,c,f,g,b=!!P.find(function(r){return r.id===e.id}),h=(null!==(n=e.costEnergy)&&void 0!==n?n:0)>r.energy||b||r.progress.level<(null!==(i=e.requiredLevel)&&void 0!==i?i:1);return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:12,background:"var(--panel-bg)",border:"1px solid rgba(255,255,255,0.08)"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:700},children:e.title}),d.jsx("div",{style:{opacity:.85,fontSize:12},children:e.desc}),r.progress.level<(null!==(a=e.requiredLevel)&&void 0!==a?a:1)&&d.jsxs("div",{style:{opacity:.85,fontSize:12,marginTop:4,color:"#e7a"},children:["–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ä. ",null!==(l=e.requiredLevel)&&void 0!==l?l:1]}),d.jsxs("div",{style:{opacity:.85,fontSize:12,marginTop:4},children:["–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ",e.durationSec/60," –º–∏–Ω ‚Ä¢ –¶–µ–Ω–∞: ‚ö° ",null!==(c=e.costEnergy)&&void 0!==c?c:0," ‚Ä¢ –ù–∞–≥—Ä–∞–¥–∞: ü™ô ",null!==(f=e.reward.gold)&&void 0!==f?f:0," ‚Ä¢ XP ",null!==(g=e.reward.xp)&&void 0!==g?g:0]})]}),d.jsx(s,{disabled:h,onClick:function(){return function(e){var n;try{if(v(p()))return void alert("–°–µ–π—á–∞—Å –∏–¥–µ—Ç –±–æ–π —Å –º–æ–Ω—Å—Ç—Ä–æ–º. –ö–≤–µ—Å—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.")}catch(s){}var i=null!==(n=e.costEnergy)&&void 0!==n?n:0;if(i>0&&r.energy<i)return void alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏");if(a="quest",k.active.filter(function(e){return e.kind===a}).length>=k.limits.quest)return void alert("–î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤: ".concat(k.limits.quest));var a;var l={id:e.id,kind:"quest",startedAt:m(),endsAt:m()+j(e.durationSec)},d=t(t({},k),{},{active:[].concat(o(k.active),[l])});if(A(d),y(d),i>0){var c=t(t({},r),{},{energy:Math.max(0,r.energy-i)});u(c),w(c)}}(e)},children:b?"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è":"–ù–∞—á–∞—Ç—å"})]},e.id)})})]}),d.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)"},children:[d.jsx("b",{children:"–°–∫–ª–∞–¥ –Ω–∞–≥—Ä–∞–¥"}),d.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:d.jsx(s,{onClick:function(){var e,n=r,o=i(k.vault);try{for(o.s();!(e=o.n()).done;){var a=e.value;n=b(n,a.reward)}}catch(d){o.e(d)}finally{o.f()}w(n);var l=t(t({},k),{},{vault:[]});A(l),y(l)},disabled:0===k.vault.length,children:"–ó–∞–±—Ä–∞—Ç—å –≤—Å—ë"})}),d.jsxs("div",{style:{display:"grid",gap:8,marginTop:10},children:[0===k.vault.length&&d.jsx("div",{style:{opacity:.8},children:"–ü—É—Å—Ç–æ."}),k.vault.map(function(e){var n,i;return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:12,background:"var(--panel-bg)",border:"1px solid rgba(255,255,255,0.08)"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:700},children:e.title}),d.jsxs("div",{style:{opacity:.85,fontSize:12},children:["–ù–∞–≥—Ä–∞–¥–∞: ü™ô ",null!==(n=e.reward.gold)&&void 0!==n?n:0," ‚Ä¢ XP ",null!==(i=e.reward.xp)&&void 0!==i?i:0,e.reward.energy?" ‚Ä¢ —ç–Ω–µ—Ä–≥–∏—è +".concat(e.reward.energy):""]})]}),d.jsx(s,{onClick:function(){return function(e){var n=k.vault.filter(function(r){return r!==e}),i=t(t({},k),{},{vault:n});A(i),y(i);var o=b(r,e.reward);w(o)}(e)},children:"–ó–∞–±—Ä–∞—Ç—å"})]},e.completedAt+e.id)})]})]})]})})}}})}();

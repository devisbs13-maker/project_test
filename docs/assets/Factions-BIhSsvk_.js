import{r as d,x as E,y as J,j as n,z as M,A as R}from"./index-By2cNAY-.js";import{H as S}from"./Header-CHg887X4.js";import{B as F}from"./Button-B4YQqtbm.js";import{g as z}from"./index-FU-_DbfN.js";import"./ru-DqIjrUCB.js";function W({player:a,onBack:w}){var r,l,p,f,g,u,m,x,y;const t=z(),[c,I]=d.useState([]),[s,o]=d.useState(null);d.useEffect(()=>{(async()=>{var e;try{const i=await E();i!=null&&i.ok&&i.items&&I(i.items)}catch(i){}try{const i=await J();i!=null&&i.ok&&o((e=i.factionId)!=null?e:null)}catch(i){}})()},[]);async function L(e){const i=await M(e);i!=null&&i.ok&&i.factionId&&o(i.factionId)}async function C(){const e=await R();e!=null&&e.ok&&o(null)}return n.jsxs("div",{style:{display:"grid",gap:12,padding:16},children:[n.jsx(S,{title:(l=(r=t.buttons)==null?void 0:r.guild)!=null?l:"Factions",gold:a.gold,energy:a.energy,level:a.progress.level,onBack:w}),n.jsxs("section",{style:{padding:12,borderRadius:16,background:"var(--panel-bg)",border:"var(--panel-border)",display:"grid",gap:10},children:[n.jsxs("div",{style:{opacity:.9},children:[(f=(p=t.factions)==null?void 0:p.yours)!=null?f:"Your faction",": ",n.jsx("b",{children:s?((g=c.find(e=>e.id===s))==null?void 0:g.name)||s:(m=(u=t.factions)==null?void 0:u.none)!=null?m:"None"})]}),s&&n.jsx(F,{onClick:C,children:(y=(x=t.factions)==null?void 0:x.leave)!=null?y:"Leave faction"})]}),n.jsx("section",{style:{display:"grid",gap:8},children:c.map(e=>{var i,j,b,v,h,k;return n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:12,background:"var(--panel-bg)",border:"1px solid rgba(255,255,255,0.08)"},children:[n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:700},children:e.name}),n.jsxs("div",{style:{opacity:.85,fontSize:12},children:[(j=(i=t.factions)==null?void 0:i.members)!=null?j:"Members",": ",e.members]})]}),n.jsxs(F,{onClick:()=>L(e.id),disabled:s===e.id,children:[" ",s===e.id?(v=(b=t.factions)==null?void 0:b.joined)!=null?v:"Joined":(k=(h=t.factions)==null?void 0:h.join)!=null?k:"Join"," "]})]},e.id)})})]})}export{W as default};

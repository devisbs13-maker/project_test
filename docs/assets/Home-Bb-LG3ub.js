import{r,a as f,j as t,m as y,E as v}from"./index-By2cNAY-.js";import{H as N}from"./Header-CHg887X4.js";import{B as o}from"./Button-B4YQqtbm.js";import{g as C,a as m,s as $}from"./index-FU-_DbfN.js";import{C as w,P as E}from"./PortraitCard-CMUhurTp.js";import{f as z}from"./time-WGOIUK2d.js";import"./ru-DqIjrUCB.js";const k="_wrap_yzi99_2",T="_panel_yzi99_11",F="_titleRow_yzi99_24",L="_panelGlow_yzi99_31",R="_appear_yzi99_52 _panel_yzi99_11",I="_buttonList_yzi99_93",G="_btnFull_yzi99_100",s={wrap:k,panel:T,titleRow:F,panelGlow:L,appear:R,buttonList:I,btnFull:G};function D({player:a,onOpenQuests:d,onOpenJobs:u,onOpenArena:p,onOpenGuild:g,onOpenCharacter:x,setScreen:l}){const n=C(),c=w[a.classId],[b,h]=r.useState(null),[j,_]=r.useState(0);return r.useEffect(()=>{let i=!1;return(async()=>{try{const e=await f();!i&&(e!=null&&e.ok)&&e.data&&h(e.data.tag)}catch(e){}})(),()=>{i=!0}},[]),r.useEffect(()=>{const i=()=>_(y(a.lastEnergyTs,v,a.energy,a.energyMax));i();const e=setInterval(i,1e3);return()=>clearInterval(e)},[a.energy,a.energyMax,a.lastEnergyTs]),t.jsxs("div",{className:s.wrap,children:[t.jsx(N,{title:n.title,gold:a.gold,energy:a.energy,level:a.progress.level,badgeTag:b}),a.name?t.jsxs("div",{style:{margin:"8px 14px",fontSize:12,opacity:.9},children:["@",a.name]}):null,a.energy<a.energyMax?t.jsxs("div",{style:{margin:"0 14px 8px",fontSize:12,opacity:.75},children:["+1 ",n.stats.energy,": ",z(j)]}):null,t.jsx("section",{className:"".concat(s.panel," ").concat(s.panelGlow," ").concat(s.appear),children:t.jsx(E,{img:c.img,title:"".concat(a.name?"".concat(a.name," • "):"").concat(c.title),subtitle:"".concat(c.desc,". ").concat(n.stats.level," ").concat(a.progress.level," • ").concat(n.stats.energy,": ").concat(a.energy,"/").concat(a.energyMax),size:"md",rightSlot:t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx(o,{className:s.btnFull,onClick:()=>l==null?void 0:l("square"),children:n.navWhere}),t.jsx(o,{className:s.btnFull,onClick:x,children:n.buttons.character})]})})}),t.jsxs("section",{className:"".concat(s.panel," ").concat(s.panelGlow," ").concat(s.appear),children:[t.jsx("div",{className:s.titleRow,children:t.jsx("span",{style:{opacity:.85},children:n.navWhere})}),t.jsxs("div",{className:s.buttonList,children:[t.jsx(o,{className:s.btnFull,onClick:()=>{l==null||l("quests"),d()},children:n.buttons.quests}),t.jsx(o,{className:s.btnFull,onClick:()=>{l==null||l("jobs"),u()},children:n.buttons.jobs}),t.jsx(o,{className:s.btnFull,onClick:()=>l==null?void 0:l("monster"),children:n.buttons.monster}),t.jsx(o,{className:s.btnFull,onClick:()=>l==null?void 0:l("merchant"),children:n.buttons.merchant}),t.jsx(o,{className:s.btnFull,onClick:p,children:n.buttons.arena}),t.jsx(o,{className:s.btnFull,onClick:g,children:n.buttons.guild})]})]}),t.jsxs("section",{className:"".concat(s.panel," ").concat(s.appear),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{opacity:.7,fontSize:12},children:"Ник берётся из Telegram WebApp"}),t.jsx("button",{onClick:()=>{try{localStorage.removeItem("mirevald:player"),localStorage.removeItem("mirevald:session"),localStorage.removeItem("mirevald:clan")}catch(i){}location.reload()},style:{background:"transparent",border:"none",color:"var(--gold)",cursor:"pointer",fontSize:12,textDecoration:"underline"},"aria-label":"reset-profile",children:"Сбросить персонажа"})]}),t.jsx("div",{style:{marginTop:8},children:t.jsxs("button",{onClick:()=>{const e=m()==="ru"?"en":"ru";$(e),location.reload()},className:"mire-btn",style:{padding:"6px 10px",borderRadius:10},children:[n.buttons.language,": ",m().toUpperCase()]})})]})]})}export{D as default};
